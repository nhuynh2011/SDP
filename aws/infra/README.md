# Infra
This directory contains the backend deployment script (Python 3).
The script constructs a JSON-formatted CloudFormation template (see `template.py`) and uses the Boto 3 Python SDK to upload the template.


## Usage
There is only one command line flag required to run this script; `-p` or `--path` followed by the path to a text file containing: the ACCESS key of your AWS account on the first line, and the SECRET key on the second line (and nothing else).

Format:
```
ACCESSKEY123
SECRETKEY1234567890
```


## Output
The script waits for the CloudFormation stack to finish creating.
If the creation is successful, the script creates a JSON file containing strings necessary for the frontend to communicate with the API.

Format of `confidential.json`:
```
{
  "stackName": "Name of the CloudFormation stack",
  "url": "API Gateway deployment URL",
  "x-api-key": "Value of the API key necessary to validate API requests"
}
```


## Defined Resources
The template generated by the script defines the following resources:

1. Project database (`DynamoDB` table).
2. User database (`DynamoDB` table).
3. The API (`API Gateway` REST api):
    1. `/DynamoDBResources`:
        1. `GET`
    2. `/EC2Resources`:
        1. `GET`
    3. `/Projects`:
        1. `DELETE`
        2. `GET`
        3. `POST`
        4. `PUT`
    4. `/Stacks`:
        1. `POST`
        2. `PUT`
    5. `/Users`:
        1. `GET`
        2. `POST`
4. API Deployment.
5. API Usage Plan (with API key).

Eacj API Gateway method is fulfilled by a Lambda function, corresponding to the code in `../lambda/`.
